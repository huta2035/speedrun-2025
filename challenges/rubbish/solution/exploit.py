#!/usr/bin/python3

from pwn import *

elf = ELF('../dist/rubbish')

if __name__ == '__main__':
    r = elf.process()
    
    flag_len = 0x24
    enc_flag = elf.read(elf.sym['enc_flag'], 0x400).split(b'\x00')[0]

    flag = b''
    for i in range(flag_len):
        flag += p8(enc_flag[0])
        enc_flag = enc_flag[flag_len - i + 1:]

    print(flag)

    r.sendlineafter(b': ', flag)

    r.interactive()
